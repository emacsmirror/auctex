2002-03-25  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-gs-dvips-sentinel): Treat absence of
	previews in buffer more graciously.
	(preview-parse-messages): require space before !name and !offset
	tags from AUC TeX.

	* prv-emacs.el (preview-auto-reveal, replace-highlight) 
	(preview-query-replace-reveal): moved.

	* preview.dtx (subsection{The internals}): Remove spurious space
	via \vsplit.
	(subsection{The internals}): Set \deadcycles to avoid TeX
	interfering with our \output fake.
	(subsection{Selection options}): Implement hooking into equations
	differently.  Somewhat ugly hack to circumvent amslatex/3425 bug.
	(subsection{Preview attaching commands}): keep \showboxbreadth
	and \showboxdepth operative, though set to minimal values.
	(\cmd{\everypar}): Cater for ugly LaTeX commands that hide things
	like the startup code of \paragraph in \everypar.

	* doc/problems.texi (x-symbol interoperation): Update Web address.

	* doc/readme.texi (Contacts): Remove personal Email address from
	README.

2002-03-24  Jan-Ake Larsson  <jalar@imf.au.dk>

	* doc/install.texi: Incorporated "Prerequisites" from readme.texi

	* doc/preview-latex.texi: Moved "Getting started" to readme.texi,
	also index changes

	* doc/readme.texi: Moved "Getting started" from
	preview-latex.texi, moved "Prerequisites" to install.texi, Placed
	appropriate pointers and crossreferences in README and other
	manuals

2002-03-24  David Kastrup  <David.Kastrup@t-online.de>

	* RELEASE: Info about RedHat 7.3 beta.

	* preview.dtx (subsection{The internals}): Spacing improvements.

	* prv-emacs.el (replace-highlight): advise so that query-replace
	works as reasonable.
	(preview-query-replace-reveal): Option to make this customizable.

2002-03-23  David Kastrup  <David.Kastrup@t-online.de>

	* prv-emacs.el (preview-toggle): get rid of
	isearch-open-invisible hooks and stuff; using the invisible
	property was confusing to the display engine, anyhow, and was
	about to be broken by changes in Emacs.  The current behavior for
	isearch is nicer than the default was before, so what.
	(preview-auto-reveal): New customizable option.

	* doc/problems.texi (Emacs problems): Windows availability for CVS
	Emacs.

	* doc/readme.texi: Windows availability for CVS Emacs.

	* preview.el (preview-parse-messages): Comment used regexps.

	* preview.dtx (subsection{The internals}): Removed an \everypar
	that caused bad spacing.  No idea why.  Redundant anyway.
	(subsection{Selection options}): changed displaymath option to
	put in the \everydisplay tokens at a theoretically more correct
	place.  Explicitly hooked equation and equation*: AMSLaTeX calls
	them too late to have them behave well.
	(subsection{Preview attaching commands}): Corrected
	\PreviewEnvironment which must have led to error messages for
	months.  Seems nobody cares.
	(subsection{Selection options}): Still more displaymath cosmetics.

2002-03-22  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (section{The Implementation}): fix typo in dvips
	option. Ugh.

	* preview.el (preview-bb-filesize): move to preview-gs group.
	(LaTeX-preview-setup): add bug reporter.
	(preview-report-bug): update reported options.

2002-03-22  Jan-Ake Larsson  <jalar@jalar.imf.au.dk>

	* doc/preview-latex.texi (preview-environment):
	doc rewrite. Slight other layout changes

2002-03-22  David Kastrup  <David.Kastrup@t-online.de>

	* doc/problems.texi: Edits.

	* doc/install.texi: Lots of editing

	* doc/readme.texi: same here

	* doc/preview-latex.texi: same here

	* RELEASE: Changes for 0.7.

	* TODO: Throw out stuff already implemented.

	* preview.el (preview-prefer-TeX-bb): Doc cosmetic.
	(preview-fast-conversion): Now defaults to on.
	(preview-fast-dvips-command): remove -tletter option, we do this
	better now.
	(preview-LaTeX-command): Pass new dvips option to preview.

	* preview.dtx (section{Package options}) 
	(section{The Implementation}): Add dvips option for overriding
	page dimensions/landscape and such stuff.

	* preview.el (preview-TeX-bb): comment sanitized.
	(preview-gs-init-string, preview-ps-file, preview-gs-dsc): new
	variables.
	(preview-fast-conversion): Set this customizable variable for an
	impressive speedup, particularly of the DviPS pass.
	(preview-dvips-command): moved.
	(preview-fast-dvips-command): New command for fast conversion.
	(preview-gs-restart): send initialization string to gs
	(preview-gs-open): initialize preview-gs-init-string
	(preview-gs-open): pass preview-fast-conversion into
	preview-start-dvips
	(preview-dsc-parse, preview-gs-dsc-cvx) 
	(preview-prepare-fast-conversion): New functions for using DSC
	comments.
	(preview-gs-dvips-sentinel): read DSC in.
	(preview-gs-place): remember snippet in 'queued property.
	(preview-mouse-open-eps): allow opening at position.
	(preview-gs-flag-error): take preview-gs-init-string into
	account, generate other message for fast PS conversion.
	(preview-gs-transact): allow non-empty stack in prompt, use
	preview-latex-do command in GhostScript.
	(preview-place-preview): comment correction, no eps file if ps
	generated.
	(preview-analyze-error): doc change.
	(preview-start-dvips): allow for fast version.

	* prv-emacs.el (preview-ps-image): Allow optional bounding box
	from TeX.

2002-03-21  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{Preview attaching commands}): Backward
	compatible message with TeX bounding box.

	* preview.el (preview-parse-messages): Backward compatible
	message parsing.

	* preview.dtx (subsection{The internals}, subsection{Preview
	attaching commands}): provide additional bounding box info.
	(subsection{The internals}): move location of \pr@shipend to
	before shipping out \pr@box so that we may measure/change it.
	(subsection{Selection options}): slightly changed call of old
	\everydisplay hook.
	(subsection{Preview attaching commands}): disable more warnings
	in order to decrease possible parse errors of preview.el.

	* preview.el (preview-prefer-TeX-bb): New option to fish bounding
	box from TeX output.  Not enabled by default until we get to fix
	a particular problem occuring with split environment nested in
	equation.
	(preview-TeX-bb-border): Additional slop around bounding box.
	(preview-TeX-bb): New function to calculate PostScript bb from
	TeX box dimensions in sp.
	(preview-gs-place, preview-eps-place, preview-place-preview):
	accept additional box argument.
	(preview-gs-transact): consider more box sources.
	(preview-delete-file, preview-make-filename): new semantics for
	reference-counting files.
	(preview-parse-messages, preview-analyze-error): Parse additional
	bounding box information from AUC TeX run.

2002-03-20  Nix  <nix@esperi.demon.co.uk>

	* prv-xemacs.el (preview-with-LaTeX-menus): Handle the case
	where the current menubar is not the AuCTeX one. Remove
	dead code.

2002-03-19  Nix  <nix@esperi.demon.co.uk>

	* preview.dtx: Doc fix.

	* preview.el: Require `reporter'.
	* preview.el (preview-image-creators): Doc extension.
	* preview.el (preview-eps-place): Doc fix.
	* preview.el (preview-analyze-error): Likewise.
	* preview.el (preview-gs): Grammar fix.
	* preview.el (preview-face): Likewise.
	* preview.el (preview-temp-dirs): Layout fix.
	* preview.el (preview-environment): Grammar and layout fix.

	* preview.el (preview-mouse-open-eps): Cater for XEmacs's
	more limited PostScript mode.
	* preview.el (LaTeX-preview-setup): Use `preview-mark-active' to
	cater for Emacs/XEmacs active-region detection differences.

	* prv-emacs.el (preview-nonready-icon): Doc fix.
	* prv-emacs.el (preview-image-from-icon): Likewise.
	* prv-emacs.el (preview-mark-active): New.

	* prv-xemacs.el (preview-gs-color-value): New, from prv-emacs.el.

2002-03-19  Nix  <nix@esperi.demon.co.uk>

	* prv-xemacs.el: Require overlay always, not just at compile time.

	(preview-compatibility-macros): Define only when compiling.
	(preview-defmacro): Likewise.  Teach Emacs to indent this form properly.

	Code to compensate for features missing in XEmacs:

	(face-attribute): Teach how to fake :foreground and :background.

	(find-image): Remove.
	(defimage): Likewise. There's no need for this call here; even if there
	were, the image-type analysis should take place at instantiation
	time, not definition time.

	(easy-menu-create-menu): New, after the Emacs function.
	(next-single-char-property-change): Likewise.
	(previous-single-char-property-change): Likewise.
	(with-temp-message): Likewise.
	(add-to-list): Likewise, redefining the two-argument XEmacs version.

	(copy-glyph): New, uses...
	(destructive-replace-glyph): ... this. New (and ugly). Uses...
	(map-plist): ... this. New, `map' for property lists.

	Code derived from prv-emacs.el:

	(preview-mark-active): New, handle the special XEmacs `mark-is-nil' case.
	(preview-create-icon): New.
	(preview-icon): XEmacsize from commented-out code; reindent.
	(preview-nonready-icon): Likewise.

	(preview-add-urgentization): Add docstring.
	(preview-add-urgentization): Likewise.

	(preview-image-from-icon): New.
	(preview-string-from-image): Likewise.
	(preview-make-clickable): Likewise.
	(preview-ps-image): Likewise.
	(preview-toggle): Likewise.
	(preview-inherited-face-attribute): Likewise.
	(preview-with-LaTeX-menus): Likewise.
	(preview-gs-get-colors): Likewise.

	(provide): Add.

2002-03-16  David Kastrup  <David.Kastrup@t-online.de>

	* doc/install.texi: Work in progress.

	* doc/readme.texi: Work in progress.

	* TODO: update wish list.  This is getting longer by the minute.

	* doc/Makefile.in (INSTALL, README, PROBLEMS): add -D rawfile
	option for raw text files.

	* doc/readme.texi: documentation restructuring for making README
	good on preinstalled systems.

	* autogen.sh (makeinfo): add -D rawfile option for raw text files

2002-03-15  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{Preview attaching commands}): disable
	\showmaxdepth and \showmaxbreadth.

	* preview.el (preview-place-preview): (widen) paranoia.
	(preview-back-command): same here.
	(LaTeX-preview-setup): better safe than sorry (users might call
	this wrong), so rerequire 'latex
	(preview-parse-messages): New regexp parser.  Nick, if the shy
	groups \(?: ...\) worry XEmacs, make them non-shy and adjust the
	match-... thingies appropriately.
	(preview-analyze-error): and another save-restriction...

2002-03-14  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-parse-messages): Obliterate preview-snippet
	and preview-snippet-start for general parsestate.
	(preview-analyze-error): Use parsestate and cache line number
	info from last call.  This plugs a *big* performance hog
	(goto-line).  Made buffer parsing here about 8 times faster.

2002-03-13  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{The internals}): Use
	\@arrayparboxrestore for better reset of spacing.

	* preview.el (require): avoid compiler warning.
	(preview-goto-info-page): new function
	(LaTeX-preview-setup): add preview-goto-info-page binding
	(info): add preview prefix for C-h F lookup
	(LaTeX-preview-setup): add documentation and customization menu.

2002-03-11  David Kastrup  <David.Kastrup@t-online.de>

	* Release 0.6.1

2002-03-10  David Kastrup  <David.Kastrup@t-online.de>

	* Makefile.in: Add preview.ins target.

	* doc/install.texi: Brown paper bag.

	* autogen.sh: don't prebuild doc.  We offer a separate download
	archive for people without texinfo.

	* preview-latex.spec (BuildRequires): changes for 0.6.1.

	* doc/install.texi: Some changes for 0.6.1.

	* RELEASE: Some adjustments for 0.6.1.

2002-03-09  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (LaTeX-preview-setup): Use preview-with-LaTeX-menus.

	* prv-emacs.el (preview-with-LaTeX-menus): New function
	temporarily making menus active.  This is quite different for
	XEmacs.

2002-03-09  Nix  <nix@esperi.demon.co.uk>

	* doc/preview-latex.texi: Minor typo fixes.
	* doc/problems.texi: Likewise.

2002-03-09  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (LaTeX-preview-setup): Deal with the easy-menu
	sickness so that XEmacs might work.
	(LaTeX-preview-setup): (require 'latex) unnecessary, we get
	called only if the feature has been loaded already.

2002-03-08  Alan Shutko  <ats@acm.org>

	* configure.in: When checking for texhash, use /bin/true if we
	can't find it.

2002-03-08  David Kastrup  <David.Kastrup@t-online.de>

	* doc/problems.texi (Emacs problems), doc/readme.texi: some
	brighter outlook with regard to XEmacs port.

	* preview.el (preview-gs-transact): Throw in the towel.  We don't
	use .runandhide (and .setsafe) unless we are dealing with gs with
	a version of at least 7.00.  gs-6.53 seems to provide
	.runandhide, while making it useless because
	   save .setsafe restore
	does not return to unsafer mode.

2002-03-05  David Kastrup  <David.Kastrup@t-online.de>

	* RELEASE: Few changes and explanations for 0.6.1.

	* doc/problems.texi (Font problems with Dvips): Changed pounds
	sign.  Not much of an improvement (we get the wrong character),
	but 7bit safe.  If Jan-Åke finds this as desirable as to have his
	own name mangled, we should follow at least make it pay off.

	* doc/preview-latex.texi (On EPS previews): png16m is default
	instead of png256.

	* doc/install.texi: Document 8bit problems.

	* README.CVS: updated.

	* configure.in: update to autoconf 2.52.

	* autogen.sh: Wheedle MY_LANG and MY_LC_CTYPE in if autoconf
	failed to do so.

	* preview.el: copyright extended.  Basically overhaul of
	persistent data, leads to:
	(preview-disable): clear timestamp.
	(preview-delete): Don't fiddle with ovr after it is already
	deleted.
	(preview-clearout): additional argument timestamp
	(preview-kill-buffer-cleanup): New function for killing buffers:
	properly time-stamped previews will not get their files deleted.
	(kill-buffer-hook): use it
	(before-revert-hook): use it
	(desktop-buffer-preview-misc-data): changed dissect call, work
	only if buffer unmodified.
	(preview-dissect): work with timestamp, don't destroy preview.
	(preview-buffer-restore): new function, works from saved data.
	(desktop-buffer-preview): use it.
	(preview-cleanout-tempfiles): Do things differently.
	(LaTeX-preview-setup): Call preview-buffer-restore if we
	accidently got here before setting up the desktop hooks.

2002-03-04  David Kastrup  <David.Kastrup@t-online.de>

	* doc/preview-latex.texi (Package options): doc changes, psfixbb
	documented.

	* doc/problems.texi: doc changes.

	* doc/readme.texi: doc changes (@AUCTeX).

	* doc/install.texi: doc changes.

	* doc/preview-latex.texi: some documentation amendments.

	* preview.el (preview-dissect): improve false desktop cleanups.
	(desktop-buffer-preview): handle file load oneself.
	(preview-place-preview): subtle bug leading to empty previews
	accumulating in secondary buffers.
	(preview-reinstate-preview): don't reinstate previews where the
	files have been deleted.
	(preview-TeX-inline-sentinel): Make sure "Compilation" flag gets
	cleared even on errors.
	(preview-environment): Doc change.
	(desktop-buffer-preview-misc-data, preview-dissect) 
	(desktop-buffer-preview, preview-cleanout-tempfiles) 
	(preview-active-string, preview-reinstate-preview) 
	(preview-default-preamble): Doc corrections/additions.

2002-03-02  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-gs-transact): Don't use .setsafe unless
	.runandhide is defined.  There might be no way back to unsafer
	mode otherwise.
	(preview-create-subdirectory): Be more forgiving about users
	messing up the directory organization of preview-latex, by
	manually deleting stuff under its control.

2002-03-01  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-default-option-list): add new options.

	* preview.dtx: add new package option psfixbb for getting better
	bounding boxes in the presence of PStricks and the like.

2002-02-28  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-inner-environments): New variable for
	avoiding ugly environments.
	(preview-environment): Accept a count, and avoid bad environments.
	(preview-section): Doc string fixed.

2002-02-26  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (require): suppress desktop warnings
	(preview-clearout): restrict to narrowed area.
	(desktop-buffer-preview-misc-data): widen.
	(preview-dissect): don't use subseq from cl-extra, rather butlast
	from subr.
	(preview-cleanout-tempfiles): new routine used in kill-emacs-hook
	(preview-reinstate-preview): setup kill-emacs-hook late so that
	preview-cleanout gets called after desktop saving
	(preview-create-subdirectory): same here

2002-02-25  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (TeX-active-tempdir): Changed the type.
	(preview-gs-dvips-sentinel): adjusted for that.
	(preview-gs-place): queued is now missing image
	(preview-gs-transact): that is in overlay property preview-image
	instead.
	(preview-gs-transact): adapt to new queued
	(desktop-buffer-preview-misc-data): save overlays when leaving
	desktop.
	(preview-dissect): gets details from overlay.
	(desktop-buffer-preview): restore overlays on reentry
	(kill-emacs-hook): must be run after desktop hook.
	(preview-active-string): gets passed image instead of snippet.
	(preview-make-filename): New TeX-active-tempdir type
	(preview-delete-file): same here
	(preview-place-preview): adapt to new preview-active-string
	(preview-reinstate-preview): new function for restoring a preview
	(preview-create-subdirectory): new TeX-active-tempdir type

2002-02-24  Jan-Ake Larsson  <jalar@imf.au.dk>
  
	* doc/preview-latex.texi: Incorporated docs from preview.dtx,
	minor other changes

2002-02-20  Jan-Ake Larsson  <jalar@imf.au.dk>

	* doc/preview-latex.texi: Removed isolatin1 style include and chars

2002-02-20  Alan Shutko  <ats@acm.org>

	* configure.in: Patch from Stephen Gildea
	correcting the disable-8bit-test code.

2002-02-19  Jan-Ake Larsson  <jalar@imf.au.dk>

	* Created 0.6b, which includes .info and .dvi manuals
	
	* doc/Makefile.in: Removed .info and .dvi from 'clean' target

2002-02-19  David Kastrup  <David.Kastrup@t-online.de>

	* Release 0.6

2002-02-19  Jan-Ake Larsson  <jalar@imf.au.dk>

	* Makefile.in:
	Changed target 'doc' to 'docs'. 'doc' matched the (unchanged)
	directory 'doc'.

	* preview-latex.el: Startup file for site-start.d

	* preview-latex.spec:
	Added site-start.d support and prauctex.cfg config file

2002-02-19  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx: Oops, prauctex.cfg inadvertantly overrode a
	possible "sections" option.
	(subsection{The internals}): The fake \shipout had a syntax
	error.  Why don't people report bugs?

2002-02-18  Alan Shutko  <ats@acm.org>

	* Makefile.in (all): Split out docs target so install-hint is
	still last.  Ditto install.

2002-02-18  David Kastrup  <David.Kastrup@t-online.de>

	* TODO: Add a few suggestions and throw out what has already been
	accomplished.

	* README-preview: Slight edits.

	* README.CVS: mention PROBLEMS as autogenerated file, add warning
	about autoconf earlier than 2.13.

	* RELEASE: explain about configuration files.

	* doc/preview-latex.texi: dircategory Emacs

	* doc/Makefile.in (install): correct install target for
	install-info.

	* doc/preview-latex.texi (Misplaced previews): explain about
	prauctex.cfg.

	* doc/install.texi: Write @LaTeX instead of La@TeX

	* preview.el (preview-default-preamble): Shorten stuff out that
	sits now in prauctex.cfg.

	* Makefile.in (all): cater for prauctex.cfg.  Same for other
	targets.

	* preview.dtx (section{Introduction}): Replaced TeX by \TeX and
	similar cosmetics.
	(section{Package options}): Added noconfig option, explained
	prdefault.cfg (not yet there) and prauctex.cfg.
	(subsection{Preview attaching commands}): Predefine prauctex.cfg.
	(section{Various drivers}): make installer extract it.

2002-02-18  Jan-Ake Larsson  <jalar@imf.au.dk>

	* problems.texi: Simple layout fix

	* preview-latex.spec: For 0.6 proper

	* RELEASE: Mention AUC TeX RPM on project site

	* Makefile.in: Fixed 'make clean' in doc subdir, install info
	files too

	* doc/Makefile.in: Typo corrected, fixed INSTALL_DATA

2002-02-17  Alan Shutko  <ats@acm.org>

	* doc/Makefile.in: New file, replacing the former ad-hoc build.

	* doc/install.texi: Mention --disable-8bit-test.

	* doc/problems.texi (LaTeX international characters): Mention
	--disable-8bit-test.

	* aclocal.m4 (AC_CHECK_AUCTEX): Correct --with-auctex to
	--with-tex-site.

	* configure.in: 8bit test enhancements.  Allow disabling test with
	--disable-8bit-test.  
	Check for makeinfo.
	Generate doc/Makefile.

2002-02-17  David Kastrup  <David.Kastrup@t-online.de>

	* doc/install.texi: Mention problems with 8-bit-uncleanliness.
	We need an override still.

	* doc/problems.texi (LaTeX international characters): Mention
	that configure might barf.

2002-02-15  Jan-Ake Larsson  <jalar@imf.au.dk>

	* RELEASE: RPM info added, "for RH 7.x"

2002-02-14  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview-latex.spec:
	For 0.6. Included code to build from CVS and temporary fix to allow
	build before autoconf includes docs, included patches subdir in %doc

	* doc/Makefile: Typo corrected

2002-02-11  Jan-Ake Larsson  <jalar@imf.au.dk>

	* doc/readme.texi, doc/install.texi, doc/problems.texi,
	doc/copying.texi: Include @macro defs for text-file generation

	* doc/problems.texi: Minor changes

	* doc/readme.texi: Shortened

	* doc/Makefile: Added --no-validate on README

	* doc/install.texi: Layout changes, xref to PROBLEMS shortened

	* doc/problems.texi:
	Layout changes, added text on bug reports and GS EPS handling

	* doc/preview-latex.texi: Layout changes, install-info fix, index
	additions, fixed direntries for preview-latex

2002-02-11  David Kastrup  <David.Kastrup@t-online.de>

	* doc/Makefile (install): install the renamed info files.

	* doc/preview-latex.texi: change output file name to
	preview-latex.info in order to keep preview-latex as a directory
	name for HTML output.

	* doc/Makefile (preview-latex/index.html): generate HTML with
	makeinfo as texi2html does not grok @preview-latex.

	* doc/preview-latex.texi: Write Å instead of @AA (x-symbol sneaked
	that in).  And revert again: does not print.

	* doc/install.texi: Use @previewlatex.

	* doc/problems.texi: Use @previewlatex and @uref.

	* doc/readme.texi: Use @previewlatex.

	* doc/copying.texi: Use @previewlatex.

	* doc/preview-latex.texi (top): Introduce @previewlatex macro and
	use it throughout.  Some more changes.

2002-02-09  David Kastrup  <David.Kastrup@t-online.de>
	
	*  INSTALL README PROBLEMS: removed because autogenerated
	*  README.CVS and autogen.sh added.

	* doc/problems.texi: Initial rendition of PROBLEMS file in
	texindex form.

	* doc/copying.texi: Change Preview La@TeX{} to preview-latex

	* preview.el (preview-image-creators): Change png default device
	to png16m due to popular request.

	* doc/readme.texi: overhaul for 0.6.

	* doc/preview-latex.texi: fat overhaul.

	* preview.dtx (section{The Implementation}): Simplify \pr@advise,
	it broke the delayed option.
	(subsection{Preview attaching commands}): Same.

2002-02-08  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-gs-transact): Sigh.  Some refinements to the
	SAFER stuff: restart gs on errors that seem to stop in SAFER mode.
	(preview-gs-transact): And another few changes, there are gs
	versions that have .setsafer but not .runandhide.  Rats.

2002-02-07  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{Preview attaching commands}): Use
	\nofiles instead of \@fileswfalse in order to suppress erroneous
	log file output.

	* preview.el (preview-gs-options): Remove -DSAFER option that
	causes OutputFile selection of GhostScript to fail (starting with
	7.04).  This cannot be the final fix.
	(preview-gs-options): Ok, so it isn't.  Restored -dSAFER and added
	-dDELAYSAFER (which should be ignored by earlier GhostScript
	versions).  Also:
	(preview-gs-transact): call .setsafe procedure if defined in
	systemdict, so we don't get unsafer in GhostScript 7.04.

2002-02-06  Jan-Ake Larsson  <jalar@imf.au.dk>

	* readme.texi: Index and layout changes

2002-02-05  Jan-Ake Larsson  <jalar@imf.au.dk>

	* copying.texi: Less zealous index

	* readme.texi: Typo corrected

	* preview-latex.texi: Document preview-default-preamble, bumped
	release number, typos corrected.

	* doc/Makefile: Simpler index generation

2002-02-04  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview-latex.texi: Simplify to only one section for keys and
	lisp function sections. Also only one Index.

2002-02-01  David Kastrup  <David.Kastrup@t-online.de>

	* PROBLEMS: Tell about x-symbol 4.0h/beta working successfully
	with preview-latex.	

2002-02-01  Alan Shutko  <ats@acm.org>

	* configure.in: Corrected error message for 8-bit test.

2002-01-30  Alan Shutko  <ats@acm.org>

	* configure.in: Added diversion at the beginning to allow us to
	save LANG and LC_CTYPE for the 8-bit test.  Also added test to see
	if LaTeX is 8-bt clean.

2002-01-24  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview-latex.spec: Initial version. On the 0.5.8.2 release.

2002-01-22  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (LaTeX-preview-setup): quote created directory name
	in %m fields.

2002-01-18  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{The internals}): Try catering for output
	routine changes.

2002-01-18  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview.el (preview-make-preamble): Simplified the code by sorting
	TeX-expand-list better.

2002-01-18  David Kastrup  <David.Kastrup@t-online.de>

	* RELEASE: Document a few changes.

	* doc/preview-latex.texi: document preview-at-point

	* preview.el (preview-next-border): Doc change.
	(preview-at-point): renamed from preview-dwim.
	(LaTeX-preview-setup): use preview-at-point.
	(LaTeX-preview-setup): menu change.
	(preview-document-pt): Use TeX-style-list instead of
	TeX-active-styles so that AucTeX may parse if not yet done.
	(before-revert-hook): clearout previews on revert.

2002-01-17  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview.el (preview-default-preamble): Added default preamble
	for use when a document not configured for preview-latex is
	previewed in AUC TeX. 
	
	* preview-latex.texi (section Misplaced previews): Info on \emph
	and \PreviewMacro*.

2001-12-05  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview-latex.texi: Added new section: User-level lisp functions

	* install.texi: Layout improvements

	* doc/Makefile: Typo and dependencies corrected

2001-12-04  Jan-Ake Larsson  <jalar@imf.au.dk>

	* doc/Makefile: Added index generation for DVI docs

2001-12-03  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview-latex.texi:
	Keymap documentation and general text on emacs interface added

	* readme.texi, install.texi: Layout changes

2001-12-03  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-clearout): add optional argument keep-dir.
	(preview-place-preview): Don't clearout previews from current
	run.  This makes preview-latex keep multiple previews in command
	arguments instead of just keeping the last such one.

2001-11-30  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (section{Provided Commands}): Add descriptions of
	new commands \PreviewMacro* and \PreviewEnvironment*.
	(subsection{The internals}): New internal \pr@protect.
	(subsection{Preview attaching commands}): Implement the new
	`*'-forms.
	(subsection{Preview attaching commands}): 
	Also treat \end{env} in \PreviewEnvironment*.

2001-11-30  Jan-Ake Larsson  <jalar@imf.au.dk>

	* preview-latex.texi, install.texi:
	Autoload the package rather than require it.

2001-11-30  David Kastrup  <David.Kastrup@t-online.de>

	* prv-emacs.el (preview-register-change): widen before getting
	substring in order to avoid error when narrowed.
	(preview-check-changes): Same here.
	(preview-handle-insert-in-front): Changed DOC string.
	(preview-handle-insert-behind): same.
	(preview-handle-modification): same.

2001-11-29  Jan-Åke Larsson <jalar@imf.au.dk>

	* doc/preview-latex.texi: Created first draft

	* doc/readme.texi: Created first draft

	* doc/readme.texi: Created first draft

	* doc/copying.texi: Created

	* doc/Makefile: Created layout. Now for autoconf, Alan?
	
2001-11-28  Alan Shutko  <ats@acm.org>

	* INSTALL (--with-tex-site): Rename --with-auctex.

	* aclocal.m4 (AC_CHECK_AUCTEX): Try to fix things so that it looks
	for tex-site, only tex-site, and adds the location of tex-site
	into the load-path.
	(AC_CHECK_REQUIRE): New.
	(AC_CHECK_AUCTEX): Change name of --with-auctex to --with-tex-site.

2001-11-12  Alan Shutko  <ats@acm.org>

	* Makefile.in (lispdir): Remove /preview because @lispdir@ now
	includes it. 

	* aclocal.m4 (AC_PATH_LISPDIR): Modify it so it prints out
	that lisp files are going in $lispdir/preview.

2001-11-20  David Kastrup  <David.Kastrup@t-online.de>

	* README-preview: adjust instructions because preview.ins will be
	available on CTAN already.

	* prv-emacs.el (preview-make-clickable): consult
	`preview-button-1' and `preview-button-2' at run-time.
	(preview-overlay): Need insert-behind-hooks too in case someone
	uses `insert-before-markers' at end of previews.
	(preview-change-list): New variable.
	(preview-register-change): New function.
	(preview-check-changes): New function.  All of this stuff is to
	make sure we open/disable overlays only if permanent changes occur
	inside.
	(preview-handle-insert-in-front): some changes for new behaviour.
	(preview-handle-insert-behind): New function.
	(preview-move-point): Call `preview-check-changes' after commands.
	(preview-gs-color-value): checkdoc-compatible comment.

	* preview.el: Change installation comments

2001-11-15  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (section{Provided Commands}): Correct documentation
	names for \PreviewEnvironment and \PreviewSnarfEnvironment

	* prv-emacs.el (preview-inherited-face-attribute): Add document
	string, simplify some tests.

	* preview.el: Add autoload magic comments.
	(preview-compatibility-macros): avoid byte compiler warning.

2001-11-13  David Kastrup  <David.Kastrup@t-online.de>

	* PROBLEMS: Add patch for mouse-drag.el

	* INSTALL: add autoload instructions for fastest Emacs startup.

2001-11-12  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-gs-restart): Use push.
	(preview-clearout-buffer): New function.  Use in kill-buffer-hook.
	(kill-emacs-hook): add cleanout of temp directories when leaving
	Emacs.
	(preview-make-options): cosmetics
	(LaTeX-preview-setup): add keybindings for clearing buffer
	(preview-clean-subdir): cosmetic changes.
	(preview-clean-topdir): new function.
	(preview-create-subdirectory): use it.
	(preview-report-bug): report preview-dvips-command.

2001-11-11  David Kastrup  <David.Kastrup@t-online.de>

	* Release 0.5.8.2

2001-11-11  Alan Shutko  <ats@acm.org>

	* aclocal.m4 (AC_EMACS_CHECK_LIB_WITH_LIB): varient of
	AC_EMACS_CHECK_LIB which first requires a prereq lib.
	(AC_CHECK_AUCTEX): Use AC_EMACS_CHECK_LIB_WITH_LIB to prereq
	tex-site.

	* Makefile.in (use-hint): Get line wrapping right.

	* configure.in (--with-texmf): Applied patch from Hans Fredrik
	Nordhaug making --with-texmf obey TDS.

2001-11-11  David Kastrup  <David.Kastrup@t-online.de>

	* prv-emacs.el (preview-transparent-border): Change definition to
	numeric/nil, set default to 3pt.
	(preview-create-icon): adapt heuristic-mask accordingly
	(preview-ps-image): same here
	(preview-gs-get-colors): use new definition of
	preview-transparent-border, use PostScript code not subject to
	anti-aliasing effects.
	(preview-transparent-border): Change default to take into
	account that we previously got only half of requested width.
	(preview-gs-get-colors): generate only necessary tokens.  Disable
	stroke adjustment in order to get more even borders.

2001-11-10  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{The internals}): Make reassignment of
	\@tempboxa that lead to missing section headers local.
	Interesting bug.

2001-11-09  David Kastrup  <David.Kastrup@t-online.de>

	* RELEASE: initial stab at release notes.

	* preview.el (preview-back-command): Make token backer somewhat
	more robust.
	(preview-analyze-error): Don't bomb out if no token matches.

	* README-preview: first draft.

	* prv-emacs.el (preview-int-bb): moved from preview.el

	* preview.el (preview-preserve-indentation): New option, on per
	default.  Switch off for old behaviour.
	(preview-extract-bb): heed preview-preserve-indentation by faking
	the bounding box left.
	(preview-int-bb): move to prv-emacs.el

	* preview.dtx (subsection{The internals}): Try killing off indents
	in order to get good horizontal positioning of preview.

	* preview.el (preview-start-dvips): fix bug WRT free variable
	`buffer'.

	* prv-emacs.el (preview-transparent-color): change default for a
	new default transparency scheme.
	(preview-get-heuristic-mask): bug fix for specified color
	(preview-create-icon): adjust for new policy
	(preview-ps-image): same here
	(preview-transparent-border): new option
	(preview-gs-get-colors): heed this

2001-11-08  David Kastrup  <David.Kastrup@t-online.de>

	* PROBLEMS: Recommend customizing new variable
	preview-dvips-command for DviPS problems.
	Add sections about Windows and XEmacs.
	Add section about LaTeX/language environment problem.
	Add section about flyspell.el including patch.

2001-11-07  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-gs): and other groups: set :prefix in
	defgroup
	(preview-get-geometry): Oops, make it work if
	preview-scale-function is a constant instead of a function.

2001-11-06  Alan Shutko  <ats@acm.org>

	* aclocal.m4 (AC_CHECK_AUCTEX): Revert the previous change, since
	it was horribly broken, and fix --with-auctex, so that it doesn't
	do the check if --with-auctex was specified.

2001-11-06  Alan Shutko  <ats@acm.org>

	* aclocal.m4 (AC_CHECK_AUCTEX): Try looking for tex-site instead
	of tex-buf... this may help since we're sure it's in load-path,
	but I'm afraid that the contents of tex-site may not be standard
	enough across installations.
	

2001-11-06  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-image-creators): Add preview-eps-open
	function for calling dvips conversion.
	(preview-eps-open): Resume half-hearted support of postscript
	image type.  Does anybody use this, after all?  If so, let him
	run DviPS in background if he so desires...

	* preview.dtx (subsection{The internals}): add \leavevmode to make
	things like \paragraph flush their \everypar tokens.  Perhaps not
	the right thing to do, let's wait for error reports about that
	one.

	* preview.el: require 'tex-site when compiling
	(preview-gs-file): new local variable
	(preview-gs-sentinel): cater for "Compilation" flag in mode-line
	(preview-gs-restart): changes in process setup
	(preview-gs-close): Same here
	(preview-gs-open): Same here
	(preview-gs-dvips-sentinel): New function
	(preview-gs-place): postpone Bounding Box extraction.
	(preview-gs-flag-error): cosmetic changes
	(preview-gs-transact): extract bounding box
	(preview-LaTeX-command): Remove dvips call from command
	(preview-dvips-command): New option for dvips call
	(preview-parse-messages): add message while parsing
	(preview-parse-messages): remove call to open, this calls parsing
	instead.
	(preview-start-dvips): New function.
	(preview-TeX-inline-sentinel): Changed to new process model
	Note: this breaks 'postscript image support.  To be fixed.
	
2001-11-03  Alan Shutko  <ats@acm.org>

	* aclocal.m4
	(AC_CHECK_PROG_REQUIRED,AC_CHECK_PROGS_REQUIRED,AC_PATH_PROG_REQUIRED):
	New functions to check programs, and abort with a message if not
	found.
	(AC_EMACS_CHECK_LIB): Function stolen from Gnus to check whether
	an elisp library exists.
	(AC_CHECK_AUCTEX): Check if AUC-TeX is in a normal emacs load
	path, and allow --with-auctex switch to specify it. SF Bug
	#477262, #477260.

	* Makefile.in (use-hint, install-hint): New hints.  SF Bug #477282.
	(all, install): Use the above hints.

	* configure.in: Changed all AC_CHECK_PROG(S)/AC_PATH_PROG(S) to
	new AC_*_REQUIRED, which abort and print a message if something
	isn't found.  Added AC_CHECK_AUCTEX.  Add note at end of configure
	to run "make".  SF Bug #469741 (partial).
	
	Removed --with-auctex since that's now done in AC_CHECK_AUCTEX.

2001-10-30  David Kastrup  <David.Kastrup@t-online.de>

	* prv-emacs.el (preview-make-clickable): Use 'keymap instead of
	'local-map, obliterating the need to inherit from LaTeX-mode-map.
	(preview-toggle): Same here, and cater for null-length overlays.
	(preview-mark-point): Jury's still out on that one.

	* preview.el (preview-gs-sentinel): Don't hickup if buffer got
	killed.
	(preview-gs-restart): Don't mind exiting Emacs if GhostScript
	still running.
	(preview-snippet): Buffer-locality not needed because parsing
	occurs fully blocking.
	(preview-snippet-start): Same
	(preview-analyze-error): Somewhat saner behaviour if the error
	message parsing fails due to macro arguments or other.  This
	cannot be the final verdict.

	* TODO: add a few items.

	* prv-emacs.el (preview-transparent-color): Make transparency
	customizable.  Note that due to a bug everything except "None" is
	treated the same as "Autodetect" in 21.1.  Fixed in CVS.
	(preview-get-heuristic-mask): Function for calculating mask to use
	from above.
	(preview-create-icon): use preview-get-heuristic-mask
	(preview-ps-image): same.
	(preview-mark-point): move point out of previews before starting
	next command for consistent implementation of intangibility.  Not
	sure whether this is actually a good idea, though.
	(preview-inherited-face-attribute): New function
	(preview-gs-get-colors): New function, replaces preview-get-colors

	* preview.el (preview-gs): New customization group hierarchy
	(preview-appearance): same
	(preview-latex): same
	(preview-gs-colors): change string to single tokens.
	(preview-gs-transact): construct string from same
	(preview-scale-from-face): consult preview-reference-face instead
	of default.  Use new function preview-inherited-face-attribute for
	this.
	(preview-face): add different colours for dark backgrounds.
	change default background to beige, probably less likely to match
	users default background.
	(preview-error-face): change preview-error-face for non-color terms.
	(preview-reference-face): used for size and color determination of
	previews.
	(preview-TeX-inline-sentinel): tell user while we are parsing

2001-10-27  David Kastrup  <David.Kastrup@t-online.de>

	* PROBLEMS: revert AucTeX patch to that before we tried our luck
	with intangibility.  Some changes in formatting.  Add comment
	about -Pwww font problems.

2001-10-26  David Kastrup  <David.Kastrup@t-online.de>

	* Release 0.5.8.1

	* preview.el (preview-mouse-open-eps): fix a typo in help
	message.
	(preview-analyze-error): Remove traces of inhibit-point-motion
	madness.  If search for (concat string after-string) fails, try
	again just with string in order to support uses of Auc-TeX's
	original interface.

	* prv-emacs.el (preview-toggle): Don't reactivate disabled
	overlays (could happen in isearches ended by an editing operation).
	(preview-move-point): While we are simulating point-adjustment,
	heed disable-point-adjustment in order to make isearch (and
	probably other utilities) Do The Right Thing (TM).  Works
	beatifully.

	* preview.el (preview-LaTeX-command): new customization variable.
	(LaTeX-preview-setup): use it.

2001-10-25  David Kastrup  <David.Kastrup@t-online.de>

	* We now cater for people with non-black-on-white setup.

	* prv-emacs.el (preview-get-colors): gets colors from default
	font.

	* preview.el (preview-gs-colors): new variable for GhostScript
	color setup string.
	(preview-gs-transact): pass color setup.
	(preview-get-geometry): pass color setup

	* prv-emacs.el (preview-ps-image): Don't expect white background
	in heuristic-mask.

	* preview.el (preview-next-border): Can't get everything right
	first try now, can I?

	* prv-emacs.el: replace preview-intangible by preview-state.
	(preview-handle-insert-in-front): Same here.
	(preview-toggle): Same here.
	(preview-toggle): Let preview-toggle handle setting of category.
	That way category is not set/used outside of prv-emacs.el.
	(preview-move-point): replace preview-intangible by
	preview-state.
	
	* preview.el (preview-dwim): replaces preview-again.
	Excruciatingly useful function bound to C-c C-p C-p.  Will do just
	what you want whenever you call it.
	(preview-next-border): Helper-function for that
	(preview-disable): set property 'preview-state
	(preview-clearout): use 'preview-state instead of 'category
	(preview-place-preview): same here.
	(LaTeX-preview-setup): use preview-dwim in keyboard bindings

2001-10-23  David Kastrup  <David.Kastrup@t-online.de>

	*  Release 0.5.8

	* PROBLEMS (AucTeX): remove patch for intangibility problem.

	* preview.el (preview-regenerate): use preview-region
	(preview-region): New user function.
	(preview-environment): New user function.
	(preview-section): New user function.
	(preview-again): New user function.
	(LaTeX-preview-setup): Add menus and keyboard shortcuts for new
	user functions.
	(preview-version): Don't recalculate version in compiled form.

	* prv-emacs.el: inherit from LaTeX-mode-map in order to have
	normal commands work when cursor is on preview.
	(preview-make-clickable): same.
	(preview-overlay): don't make intangible, but preview-intangible.
	In short, we now fake intangibility until Emacs will keep the
	cursor out of overlay images like it does out of text property
	images.
	(preview-handle-insert-in-front): Same here.
	(preview-toggle): Same here.  Load pre-command-hook and
	post-command-hook for fake intangibility.
	(preview-marker): Added for fake intangibility.
	(preview-mark-point): pre-command-hook function for fake
	intangibility.
	(preview-move-point): post-command-hook function for fakr
	intangibility.

2001-10-22  David Kastrup  <David.Kastrup@t-online.de>

	* README: Change info for Emacs release 21.1

	* PROBLEMS: Change info for Emacs release 21.1

	* INSTALL: Change info for Emacs release 21.1

2001-10-19  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{The internals}): Heed \AtBeginDvi
	sequences.  Small doc/formatting changes.

2001-10-17  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx: Get the version headers right (hopefully).

2001-10-16  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx: Make a stab at an automated version header
	(subsection{Preview attaching commands}): Move the badness stuff
	to the auctex option.

2001-10-15  David Kastrup  <David.Kastrup@t-online.de>

	* prv-emacs.el:  insert-in-front back.  Discovered all-saving
	undo-in-progress.
	(preview-handle-insert-in-front): pseudo-advance if not in undo
	while iconized.
	(preview-handle-modification): fitting behaviour for that. commit
	suicide on changes that leave the range empty, disable else.

	* preview.el (preview-place-preview): overlays get auto-advancing
	front.
	(preview-analyze-error): intangible.  inhibit-point-motion-hooks.
	what a mess.  Made parsing saner in the presence of such stuff.
	(preview-place-preview): overlays get non-auto-advancing front
	back again, since we rather pseudo-advance in
	preview-handle-insert-in-front.

	* prv-emacs.el: don't handle insert-in-front: impossible to do
	consistently.  Instead make beginning ofg overlays auto-advance
	always.
	(preview-handle-insert-in-front): removed
	(preview-handle-modification): removed insert-in-front-hooks

2001-10-13  David Kastrup  <David.Kastrup@t-online.de>

	* prv-xemacs.el: This is completely and utterly broken and
	incomplete.  The recent changes from Simon have not yet been
	incorporated, some of the stuff still has old semantics and so
	forth and so on.  One needs to go through prv-emacs.el and make
	sure that everything in there has an equivalent here.

	* prv-emacs.el: See preview.el.

	* preview.el: This is the big one.  Changes too numerous to
	mention.  Lots of modularization for making XEmacs support
	possible.  Changed semantics, the works.  See PROBLEMS file for
	new AucTeX compatibility annoyances.

	* PROBLEMS (AucTeX versions from 11.01 up to version 11.05): Patch
	added.  Patch for earlier versions revised.

2001-10-12  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{Preview attaching commands}): set
	\hbadness and \vbadness to infinity in order to avoid
	parse-unfriendly error messages.  Would one want to see overfull
	hbox rules in preview output?

2001-10-12  Alan Shutko  <ats@acm.org>

	* Makefile.in (LISP_OBJS): New var.
	($(LISP_OBJS)): Got rid of elc target and used dependencies, so we
	don't recompile every make.

2001-10-12  David Kastrup  <David.Kastrup@t-online.de>

	* configure.in: Try fixing the emacs flavor detection.
	And revert back to Alan's version.

2001-10-12  Alan Shutko  <ats@acm.org>

	* configure.in: Change AC_PATH_PROG of emacs to AC_CHECK_PROG, as
	it was breaking --with-xemacs.

2001-10-12  David Kastrup  <David.Kastrup@t-online.de>

	* Makefile.in: Switch order of LISP_SOURCES in order to avoid
	compiling preview.el with older versions of prv-emacs.elc or
	prv-xemacs.elc

2001-10-11  Alan Shutko  <ats@acm.org>

	* Makefile.in (ELCC): Bug 469742: Include . in load path.

	* configure.in: Added --with-xemacs option.  Added AC_XEMACS_P to
	determine if we're using xemacs.  Added PLAT_LISP substitution
	with the flavor-specific lisp file.

	* Makefile.in (LISP_SOURCES): New variable, listing files needing
	byte-compilation.
	(all): Depend on "elc" target to capture all the emacs files.
	(install-el): Install more lisp files.
	(elc): New target, compile all relevant files.

2001-10-11  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{The internals}): Introduce count
	\pr@snippet so as not to get confused by \include.
	(subsection{Preview attaching commands}): Make auctex option use
	this counter.

2001-10-10  David Kastrup  <David.Kastrup@t-online.de>

	* circ.tex: Demonstrate new `sections' option.

	* preview.el (preview-default-option-list): Cater for new
	`sections' option to preview.sty.

	* preview.dtx (section{Provided Commands}): New argument syntax as
	in \PreviewMacro[{*[][]{}}]{\includegraphics}.
	(subsection{Parsing commands}): introduce \pr@endparse and support
	new syntax.
	(subsection{Preview attaching commands}): same here.
	(section{Package options}): explain new `sections' option.
	(subsection{Selection options}): implement `sections' option.

2001-10-09  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-mouse-open-error): Don't have multiple
	"*Preview-GhostScript-Error*" buffers gather, reuse single one.
	(LaTeX-preview-setup): Enter us into "Command" menu.

2001-10-08  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx (subsection{Preview attaching commands}): Change
	output routine to flush out floats.
	Correct \CheckSum.

	* preview.el: Use `error' identifier only where really needed.
	(preview-gs-behead-outstanding): see above.
	(preview-gs-sentinel): see above.
	(preview-gs-flag-error): see above.
	Still require (defvar error) because of Auc-TeX
	(TeX-active-tempdir): Move definition.
	(preview-gs-place, preview-eps-place)
	(preview-active-string, preview-make-filename)
	(preview-place-preview, preview-parse-messages)
	(preview-analyze-error): remove `tempdir' argument
	(preview-get-geometry): some change in semantics
	(preview-TeX-inline-sentinel): call `preview-parse-messages' with
	process buffer active instead of source.
	(TeX-inline-preview): adapt to changed `preview-get-geometry'

2001-10-07  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-get-geometry): comment clarification to
	satisfy checkdoc.
	(preview-version): added.
	(preview-report-bug): use `preview-version' instead of current
	ugliness.

	* .cvsignore (Module): Add a few more entries.

	* preview.el: Don't defvar AucTeX internal TeX-auto-file, make
	auto-size detection of previews from parsed styles work.
	(preview-document-pt): Use `TeX-active-styles' instead of bad AucTeX
	internal `TeX-auto-file'.
	(preview-get-geometry): Different arguments and semantics.  Make
	it work.
	(TeX-inline-preview): Call changed `preview-get-geometry'.

	* prv-xemacs.el: add macros line-beginning-position and
	line-end-position.

	* preview.el: Change manner of loading prv-xemacs
	(preview-analyze-error): Use line-end-position again.

2001-10-05  David Kastrup  <David.Kastrup@t-online.de>

	* preview.dtx: Include \ProvidesPackage and \CheckSum
	(subsection{Preview attaching commands}): put \unskip in
	\end{preview} where it will make a difference.
	(section{Various drivers}): \askforoverwritefalse only generated
	for make-intended installer.

	* prv-xemacs.el: require overlay
	preview-compatibility-macros added
	(find-image): some changes of compilation
	(defimage): define using preview-defmacro
	(make-temp-file): ignore temporary-filename: not needed in here.

2001-10-04  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el: first stab at XEmacs compatibility.

	* prv-xemacs.el: first stab at XEmacs compatibility.

	* circ.tex (section{Die gerade Linie}): built in two deliberate
	bugs for testing.

	* preview.el (preview-gs-behead-outstanding): use
	`preview-gs-flag-error'.
	(preview-mouse-open-error, preview-mouse-open-eps): factored out
	stuff from `preview-gs-flag-error'.
	(preview-gs-flag-error): replaces `preview-gs-error-string'
	(preview-gs-transact): Use `preview-gs-flag-error'.

	* PROBLEMS: be more specific about GhostScript errors

2001-10-03  David Kastrup  <David.Kastrup@t-online.de>

	* preview.el (preview-delete-file): remove dont-register
	(preview-make-filename): remove dont-register
	(preview-regenerate): switch to clicked buffer if not there.
	(preview-gs-error-string): try to avoid strange behaviour from
	having `let' restore potential buffer-local-variables to the wrong
	buffer.  Make some functions (interactive "@").

2001-10-02  David Kastrup  <dakas@users.sourceforge.net>

        * release 0.5

	* PROBLEMS: Completed summary of patches and made an outline-mode file.

	* INSTALL:
	Gearing up for a release.  Last modifications and clarifications.

	* preview.el:
	Lots of cleanups for getting to release quality.  Made good error
	reporting with things masquerading as actual GhostScript sessions,
	including command line, prompt, messages, the works.

	Removed preview-gs-urgent which actually has never been anything
	but the front of preview-gs-queue.

	* TODO: Some more wishes.

	* preview.el: Make active error display.

	* preview.el:
	Changed the process line appearance somewhat, added a bit of
	robustness when error line parsing fails, beautified appearance of
	opened previews (icon gets its own line only when previewed area
	starts on a line).

2001-10-01  David Kastrup  <dakas@users.sourceforge.net>

	* TODO: Added a few items.

	* README: Added CVS instructions and a few other odds and ends.

	* bootstrap.ins: Remove docstrip configuration related messages.

	* INSTALL: Some more massaging.

	* PROBLEMS: Initial checkin, preparation for first tarball release.

	* ChangeLog: Initial entry of ChangeLog.

2001-10-01  alanshutko  <alanshutko@users.sourceforge.net>

	* aclocal.m4: Instead of /dev/null, throw stuff to FD 5, where it
	might do some good.

2001-09-30  David Kastrup  <dakas@users.sourceforge.net>

	* README: Mentioned M-x preview-report-bug.

	* README: Removed redundancies with INSTALL, cleared some stuff up.

	* preview.el:
	Obliterated transaction queues.  They did not help that much, and are
	not implemented in earlier versions of XEmacs.  More trouble than they
	were worth, anyway.

	* preview.el: Define a few more image types.

2001-09-29  David Kastrup  <dakas@users.sourceforge.net>

	* INSTALL: Some general information and stuff.

	* Makefile.in:
	Use latex '\nonstopmode \input ...' instead of -interaction
	nonstopmode

	Fixed string comparison in Emacs.

	* aclocal.m4:
	Remove trailing slashes after path discovery, do some more things with
	sed instead of various other utilities.  One change in calling LaTeX
	to make it work with older or non-web2c binaries.

	* preview.dtx:
	Support those misguided people using $$ in their LaTeX documents.  I
	am not sure this is a good idea, but it will probably save us bug
	reports.

	* TODO: Removed a few done points.

	* preview.el:
	Made parsing good.  Now the entire TeX error context gets used.  In
	most cases, regenerating previews should work now, as well as region
	previewing.

2001-09-28  alanshutko  <alanshutko@users.sourceforge.net>

	* INSTALL: New file

2001-09-27  alanshutko  <alanshutko@users.sourceforge.net>

	* Makefile.in (preview.elc): Patch from Simon Josefsson to fix
	build with non-standard AUCTeX location.

2001-09-27  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	Made error and abort messages appear in the faulty images.  Reworked
	file handling somewhat so that in the case of errors all involved
	files can stay until the image overlay gets deleted.

	* preview.el:
	Added bug reporting instructions and helper function for reports
	to preview-latex-bugs@lists.sourceforge.net.

2001-09-26  alanshutko  <alanshutko@users.sourceforge.net>

	* Makefile.in: (install-texmf) Install the dvi file

	* Makefile.in, aclocal.m4, configure.in:
	* aclocal.m4: Removed some dross stolen from Gnus, since it is unused.
	Fixed up AC_PATH_TEXMFDIR to try to find a dir to install the docs
	and to export texmfdir.

	* configure.in: --with-auctex=DIR, new option

	* Makefile.in: Changed rules for byte-compilation to allow setting
	AUCTEXDIR.
	(install-texmf) Only texhash the directory we installed into

2001-09-26  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	Oodles of documentation and a much faster bounding box extractor
	not relying on grep.  Some small internal changes.

	* preview.el:
	Background rendering now working without errors, even with crummy
	default tq.el as currently shipped with Emacs (and XEmacs?).

2001-09-25  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	Some initial stab at trying to make do without tq.el.  Figured out a
	way to make do with tq's ugly semantics, however.  Just keep this
	somewhere.  Only half done.

2001-09-24  alanshutko  <alanshutko@users.sourceforge.net>

	* Makefile.in:
	Makefile.in: clean and distclean targets from Simon Josefsson <jas@extundo.com>

2001-09-24  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	Sanitized temporary file handling by introducing a reference count
	scheme.  Temporary directories should now get deleted as they become
	empty.  We still do a general cleanup (in case a previous EMacs
	session crashed) on first accessing any preview subdirectory, which
	means bad luck when you are starting multiple instances of Emacs for
	previewing purposes.

2001-09-24  alanshutko  <alanshutko@users.sourceforge.net>

	* Makefile.in, configure.in:
	Run texhash after tex installation.  Also set full
	pathnames for programs, since the path of the installing user may
	not match the compiling user.

	* Makefile.in, aclocal.m4: First cut at previewdocdir

2001-09-24  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	PNG rendering now basically works and is the default.  Errors during
	transaction queue processing insert their messages into the TeX
	background buffer; so do unexpected GhostScript messages.  Good for
	debugging.

2001-09-22  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	Forgot entering into queue and a condition.  Still does not work with png.

	* preview.dtx: Fixed \begin{table} bug.

	* preview.el: Several changes from several people.

	The big one: support of other image formats. PNG.  Unfortunately, not
	yet functional.  Checked in nevertheless since the old postscript
	rendering is on by default and seems to work still.

	* preview.dtx: Forgotten macrocode, empty line.

2001-09-21  alanshutko  <alanshutko@users.sourceforge.net>

	* Makefile.in, aclocal.m4, configure.in:
	2001-09-21  Alan Shutko  <ats@acm.org>

		* aclocal.m4: Correct handling of docstrip configuration for
		non-TDS setup.  Also, quote the $ in awk.

		* Makefile.in (TEX): New variable.
		(all): preview-mk.ins instead of preview.ins
		(preview-mk.ins, preview.sty prauctex.def preview.drv): Use $TEX.

		* configure.in: Added --with-preview-dir option.  Check for tex
		executable.

	* configure.in: Clarified --with-texmf help.

	* README: Updated build directions for autoconf build.

	* .cvsignore, Makefile, Makefile.in, aclocal.m4, configure.in, install-sh:
	Makefile.in, aclocal.m4, configure.in: Create autoconf versions of
	Makefile.  Much of aclocal.m4 was stolen from Gnus, though the
	AC_PATH_TEXMF is new.

	Added install-sh for use by the makefile if a compatible install
	binary is not found.

2001-09-20  David Kastrup  <dakas@users.sourceforge.net>

	* Makefile: First sketch at installation via make instead of docstrip.

	* bootstrap.ins: No error if no docstrip.cfg.

	* bootstrap.ins:
	First sketch at bootstrap install file for extracting main installer
	and giving directory info.

	* preview.dtx: Added missing macrocode environment (David Love).
	Leave directory off installer when installing via make.

2001-09-19  David Kastrup  <dakas@users.sourceforge.net>

	* README: Checked in antialiasing suggestions from Alan Shutko.

2001-09-16  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el: Still learning about customize-variable...

2001-09-15  David Kastrup  <dakas@users.sourceforge.net>

	* preview.el:
	Parse HiRes Bounding Boxes, remove accidental paste of definition of
	shell-command-to-string, add support for graphical preview of files
	not prepared for it.

	* preview.dtx: Another spurious space.

	* preview.dtx:
	AucTeX option delays \nonstopmode.  Spurious space in \pr@endbox removed.

	* README: Add instructions for anti-aliasing.

	* preview.dtx, README: Corrected Email address.

2001-09-14  David Kastrup  <dakas@users.sourceforge.net>

	* README: Added some more descriptive stuff and my Email address.

	* preview.el: Added intelligent determination of EPS scale.
	Changed Bounding Box determination to use a HiResBoundingBox if
	present, and work without a shell.
	Added some customization.

2001-09-13  David Kastrup  <dakas@users.sourceforge.net>

	* .cvsignore: Ignore generated files.

	* preview.dtx:
	Deleted no longer applicable comment.  Fixed bug in connection with \item.

	* COPYING: Copy of GPL version 2 included.

	* README: Typo.

	* README: Clarified comment about how to improve EPS support in Emacs.

	* README: Removed link to pretest Emacs on request from Gerd Möllmann.

2001-09-12  David Kastrup  <dakas@users.sourceforge.net>

	* circ.tex: New file.

	* circ.tex: This is the initial checkin of preview-latex.  Enjoy.

	* Makefile, README, TODO, preview.dtx: New file.

	* Makefile, README, TODO, preview.dtx:
	This is the initial checkin of preview-latex.  Enjoy.

	* preview.el: New file.

	* preview.el: This is the initial checkin of preview-latex.  Enjoy.

